<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Monitor de Rendimiento Pro</title>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a, #020617);
            color: #e5e7eb;
            padding: 20px;
        }

        .dashboard {
            display: flex;
            justify-content: space-between;
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: linear-gradient(145deg, #111827, #020617);
            padding: 20px;
            border-radius: 14px;
            width: 30%;
            text-align: center;
            box-shadow: 
                0 10px 25px rgba(0, 0, 0, 0.6),
                inset 0 0 0 1px rgba(255, 255, 255, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.8);
        }

        .card h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 500;
            color: #93c5fd;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .value {
            font-size: 2.6rem;
            font-weight: bold;
            margin-top: 5px;
        }

        #cpu-text { color: #38bdf8; }   /* Azul */
        #ram-text { color: #22c55e; }   /* Verde */
        #temp-text { color: #f97316; }  /* Naranja */

        .chart-container {
            background: linear-gradient(145deg, #020617, #111827);
            padding: 25px;
            border-radius: 16px;
            height: 420px;
            box-shadow: 
                0 12px 30px rgba(0, 0, 0, 0.7),
                inset 0 0 0 1px rgba(255, 255, 255, 0.04);
        }

        canvas {
            filter: drop-shadow(0 0 8px rgba(56, 189, 248, 0.15));
        }
    </style>
</head>

<body>

    <!-- TARJETAS -->
    <div class="dashboard">
        <div class="card">
            <h3>CPU</h3>
            <div id="cpu-text" class="value">0%</div>
        </div>

        <div class="card">
            <h3>RAM</h3>
            <div id="ram-text" class="value">0%</div>
        </div>

        <div class="card">
            <h3>Temp</h3>
            <div id="temp-text" class="value">0°C</div>
        </div>
    </div>

    <!-- GRÁFICA -->
    <div class="chart-container">
        <canvas id="realtimeChart"></canvas>
    </div>

    <!-- Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>

    <script>
        const ctx = document.getElementById('realtimeChart').getContext('2d');
        const maxDataPoints = 30;

        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Uso de CPU (%)',
                        borderColor: '#38bdf8',
                        data: [],
                        fill: false,
                        tension: 0.4
                    },
                    {
                        label: 'Uso de RAM (%)',
                        borderColor: '#22c55e',
                        data: [],
                        fill: false,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        min: 0,
                        max: 100,
                        grid: { color: '#1f2933' },
                        ticks: { color: '#e5e7eb' }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#9ca3af' }
                    }
                },
                plugins: {
                    legend: {
                        labels: { color: '#e5e7eb' }
                    }
                }
            }
        });

        const socket = io();

        socket.on('datos-rendimiento', (data) => {
            document.getElementById('cpu-text').innerText = data.cpu + '%';
            document.getElementById('ram-text').innerText = data.ram + '%';
            document.getElementById('temp-text').innerText = data.temp + '°C';

            const now = new Date().toLocaleTimeString();

            chart.data.labels.push(now);
            chart.data.datasets[0].data.push(data.cpu);
            chart.data.datasets[1].data.push(data.ram);

            if (chart.data.labels.length > maxDataPoints) {
                chart.data.labels.shift();
                chart.data.datasets[0].data.shift();
                chart.data.datasets[1].data.shift();
            }

            chart.update('none');
        });
    </script>

</body>
</html>
